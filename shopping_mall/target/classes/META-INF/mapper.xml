<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.AdminMapper">

    <select id="adminIdCheckMapper" parameterType="String" resultType="int">
        SELECT COUNT(*) FROM admin_info WHERE admin_id = #{id}
    </select>
    
	<insert id="createAdminMapper">
	    INSERT INTO admin_info (admin_id, admin_pw, admin_name, admin_email, admin_tel, admin_part, admin_position, join_date)
	    VALUES (#{admin_id}, #{admin_pw}, #{admin_name}, #{admin_email}, #{admin_tel}, #{admin_part}, #{admin_position}, now())
	</insert>
	
	<select id="getAdminMapper" resultType="Map">
		SELECT *, DATE_FORMAT(join_date, '%Y-%m-%d') AS formatted_join_date FROM admin_info WHERE admin_id != 'master';
	</select>
	
	<select id="adminLoginMapper" parameterType="String" resultType="Map">
		SELECT admin_pw, permission FROM admin_info WHERE admin_id = #{id}
	</select>
	
	<select id="getAdminDetail" parameterType="String" resultType="model.AdminAuthentication">
		SELECT admin_id, admin_pw, permission FROM admin_info WHERE admin_id = #{id}
	</select>
    
    <select id="getAdminNameMapper" parameterType="String" resultType="String">
    	SELECT admin_name FROM admin_info WHERE admin_id = #{id}
    </select>
    
    <update id="modifyPermissionMapper">
    	UPDATE admin_info SET permission=
    	<choose>
    	<when test="status==1">
    		'N'
    	</when>
    	<when test="status==2">
    		'Y'
    	</when>
    	</choose>
    	 WHERE idx_admin=#{idx_admin} 
    </update>
    
    <insert id="insertSiteSettingMapper" parameterType="model.SettingSiteEntity">
	    INSERT INTO setting_site 
	    (admin_id, site_name, admin_email, point_usable, reward, auth_level, in_date) 
	    VALUES 
	    (#{admin_id}, #{site_name}, #{admin_email}, #{point_usable}, #{reward}, #{auth_level}, now())
	</insert>

    <insert id="insertCompanySettingMapper" parameterType="model.SettingCompanyEntity">
	    INSERT INTO setting_company 
	    (admin_id, company_name, business_number, ceo_name, ceo_tel, report_number, carrier_number, company_post, company_address, info_manager, info_manager_email, in_date) 
	    VALUES 
	    (#{admin_id}, #{company_name}, #{business_number}, #{ceo_name}, #{ceo_tel}, #{report_number}, #{carrier_number}, #{company_post}, #{company_address}, #{info_manager}, #{info_manager_email}, now())
	</insert>

    <insert id="insertPaymentSettingMapper" parameterType="model.SettingPaymentEntity">
	    INSERT INTO setting_payment 
	    (admin_id, bank_name, account_number, credit_card_usable, mobile_payment_usable, book_coupon_usable, min_point, max_point, receipt_usable, delivery_company, delivery_fee, delivery_date_usable, in_date) 
	    VALUES 
	    (#{admin_id}, #{bank_name}, #{account_number}, #{credit_card_usable}, #{mobile_payment_usable}, #{book_coupon_usable}, #{min_point}, #{max_point}, #{receipt_usable}, #{delivery_company}, #{delivery_fee}, #{delivery_date_usable}, now())
	</insert>
	
	<select id="getShopSettingMapper" resultType="model.AllSettingEntity">
		SELECT * FROM admin_settings
	</select>

</mapper>
